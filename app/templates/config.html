{% extends "base.html" %}
{% block title %}Timer Config{% endblock %}
{% block body %}
<div class="container">
  <div class="card fade-in">
    <div class="header">
      <h1>⏱️ Timer · Control Panel</h1>
      <div class="app-version">v1.0.0</div>
    </div>

    <div class="body stack stack--lg">
      <div class="grid-2">
        <!-- Левая колонка -->
        <div class="stack stack--lg">
          <section class="section stack stack--md">
            <label>Время (HH:MM:SS)</label>
            <div class="row row--nowrap">
              <input type="text" id="time" class="input input--timer" placeholder="00:01:00" />
              <button class="btn btn--lg" id="btn-set" type="button">Set</button>
              <a class="btn btn--lg btn--accent" href="/" target="_blank">Open Timer</a>
            </div>
            <div class="btn-group mt-2">
              <button class="btn btn--accent" id="btn-start" type="button">Start</button>
              <button class="btn" id="btn-stop" type="button">Stop</button>
              <button class="btn btn--danger" id="btn-reset" type="button">Reset</button>
            </div>
          </section>

          <section class="section stack stack--md">
            <label>Цвет текста таймера</label>
            <div class="btn-group">
              <button class="btn btn--chip" id="btn-color-black" type="button">Чёрный</button>
              <button class="btn btn--chip" id="btn-color-white" type="button">Белый</button>
              <script>
                const ctrlWS = new WebSocket(`ws://${location.host}/control`);
              
                document.getElementById("btn-color-black").addEventListener("click", () => {
                  ctrlWS.send("color black");
                });
                document.getElementById("btn-color-white").addEventListener("click", () => {
                  ctrlWS.send("color white");
                });
              </script>
            </div>
          </section>
        </div>

        <!-- Правая колонка -->
        <div class="stack stack--lg">
          <section class="section stack stack--md">
            <label>DonationAlerts · Авторизация</label>
            <div class="btn-group">
              <!-- Авторизация в этой вкладке -->
              <a class="btn btn--accent" href="/auth">Авторизоваться в DonationAlerts</a>
              <!-- Выход -->
              <button class="btn btn--danger" id="btn-logout" type="button">Выйти</button>
            </div>

            <hr class="hr" />

            <label>OAuth Access Token</label>
            <div class="row row--nowrap">
              <input type="text" id="token" class="input input--token" value="{{ token }}" placeholder="OAuth Access Token" />
              <button class="btn btn--accent" id="btn-save-token" type="button">Save Token</button>
            </div>

            <hr class="hr" />

            <label>Коэффициент (секунд за 1 ₽)</label>
            <div class="row row--nowrap">
              <input
                type="number"
                id="coef"
                class="input input--coef"
                value="{{ coef }}"
                step="0.1"
                min="0"
                placeholder="Секунд за 1 рубль"
              />
              <button class="btn" id="btn-save-coef" type="button">Save Ratio</button>
            </div>
            <div class="mt-2" style="color:var(--text-muted);">
              Например, 4.5 → 1₽ = +4.5 сек (дробные секунды накапливаются).
            </div>
          </section>
        </div>
      </div>

      <section class="section stack">
        <label>Логи</label>
        <div id="log" class="log"></div>
      </section>
    </div>

    <div class="footer-note">Made by WisperLight</div>
  </div>
</div>

<script src="/static/js/config.js?v=20251009"></script>
{% endblock %}
